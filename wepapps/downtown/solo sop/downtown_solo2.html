<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DRV 봇 시스템 규칙</title>
    <style>
        :root {
            --primary-color: #3498db;
            --primary-dark: #2980b9;
            --text-color-dark: #2c3e50;
            --text-color-medium: #34495e;
            --text-color-light: #7f8c8d;
            --danger-color: #e74c3c;
            --note-bg: #f8f9fa;
            --golden-rule-bg: #fff9e6;
            --golden-rule-border: #ffeaa7;
            --border-radius: 8px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            line-height: 1.7;
            margin: 0;
            padding: 20px;
            background-color: #fdfdfd;
            color: var(--text-color-medium);
        }
        main { max-width: 800px; margin: 0 auto; }

        h1 { color: var(--text-color-dark); border-bottom: 3px solid var(--primary-color); padding-bottom: 10px; }
        h2 { color: var(--text-color-dark); margin-top: 40px; border-bottom: 1px solid #ecf0f1; padding-bottom: 8px; }
        h3 { color: var(--text-color-light); }

        .section { margin-bottom: 40px; }
        .subsection { margin-left: 0; margin-bottom: 20px; }
        ul, ol { padding-left: 20px; }
        li { margin-bottom: 8px; }

        .note { background-color: var(--note-bg); padding: 15px; border-left: 5px solid var(--primary-color); margin: 20px 0; border-radius: 0 var(--border-radius) var(--border-radius) 0; }
        .golden-rule { background-color: var(--golden-rule-bg); padding: 20px; border: 1px solid var(--golden-rule-border); border-left: 5px solid #f1c40f; border-radius: var(--border-radius); }
        .table-ref {
            color: var(--danger-color);
            font-weight: bold;
            background-color: #fceded;
            padding: 2px 6px;
            border-radius: 4px;
            cursor: pointer;
        }
        .red { color: var(--danger-color); }

        /* Floating Action Button and Modal Styles */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 56px;
            height: 56px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 56px;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 1000;
            transition: transform 0.2s;
        }

        .fab:hover {
            transform: scale(1.05);
            background-color: var(--primary-dark);
        }

        .modal {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 90vw;
            max-width: 650px; /* 최대 너비 축소 */
            max-height: 700px;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1001;
            display: flex;
            flex-direction: column;
            visibility: hidden; opacity: 0;
            transform: scale(0.95) translateY(10px);
            transition: opacity 0.2s ease-out, transform 0.2s ease-out;
            pointer-events: none;
        }

        .modal-dialog {
            padding: 10px 15px;
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center; 
            border-top-left-radius: var(--border-radius);
            border-top-right-radius: var(--border-radius);
            cursor: move;
        }

        .close-button {
            font-size: 24px;
            cursor: pointer;
        }

        .modal-content {
            flex-grow: 1; 
            padding: 15px; 
            overflow-y: auto;
            font-size: 16px; /* 기본 폰트 크기 증가 */
        }

        /* Modal content specific styles to match the source */
        .modal-content p { margin: 8px 0; }
        .modal-content ul, .modal-content ol { padding-left: 20px; margin: 8px 0; }
        .modal-content li { margin-bottom: 5px; line-height: 1.5; }
        .modal-content .table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            background: white;
            border-radius: 4px;
            overflow: hidden;
            font-size: 14px; /* 테이블 폰트 크기 증가 */
        }
        .modal-content .table th {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            padding: 6px 8px;
            text-align: left;
            font-weight: bold;
            font-size: 13px; /* 테이블 헤더 폰트 크기 증가 */
        }
        .modal-content .table td {
            padding: 6px 8px;
            border-bottom: 1px solid #ecf0f1;
            vertical-align: top;
            font-size: 14px; /* 테이블 셀 폰트 크기 증가 */
            line-height: 1.4;
        }
        .modal-content .table tr:nth-child(even) { background: #f8f9fa; }
        .modal-content .highlight {
            background: #fff3cd;
            padding: 10px;
            border-radius: 3px;
            border-left: 3px solid #ffc107;
            margin: 8px 0;
            font-size: 15px; /* 하이라이트 폰트 크기 증가 */
        }
        .modal-content .note {
            background: #d1ecf1;
            padding: 10px;
            border-radius: 3px;
            border-left: 3px solid #17a2b8;
            margin: 8px 0;
            font-style: italic;
            font-size: 15px; /* 노트 폰트 크기 증가 */
        }
        .modal-content .dice-formula {
            background: #fff3cd; color: #856404; padding: 2px 5px; border-radius: 3px;
            font-weight: bold; font-family: monospace; font-size: 14px; /* 공식 폰트 크기 증가 */
        }
        .modal-content .result {
            background: #d4edda; color: #155724; padding: 2px 5px; border-radius: 3px;
            margin: 2px 0; display: inline-block; font-size: 14px; /* 결과 폰트 크기 증가 */
        }
        .modal-content .modifier {
            background: #f8d7da; color: #721c24; padding: 2px 5px; border-radius: 3px;
            margin: 2px 0; display: inline-block; font-size: 14px; /* 보정치 폰트 크기 증가 */
        }
        .modal-content .red-bold-text { color: red; font-weight: bold; }
        .modal-content .aircraft-type {
            font-weight: bold; color: #2c3e50; background: #ecf0f1; padding: 2px 4px;
            border-radius: 3px; font-size: 13px; /* 항공기 타입 폰트 크기 증가 */
        }

        .modal.show { visibility: visible; opacity: 1; }
        .modal.show {
            opacity: 1;
            transform: scale(1) translateY(0);
            pointer-events: auto;
        }

        /* 플레이 순서(sop.html) 모달 크기만 별도 조정 */
        #sopModal {
            width: 90vw;
            max-width: 850px; /* 너비 증가 */
            height: 85vh; /* 높이 증가 */
        }
    </style>
    <style>
        /* 무작위 이벤트 모달 크기만 별도 조정 */
        #refModal.modal-large {
            max-width: 1000px; /* 너비 증가 */
            max-height: 90vh; /* 높이 증가 */
        }
    </style>
</head>
<body>
<main>
<h1>1. 소개 & 구성요소</h1>

<div class="section">
    <h2>1.1 개요</h2>
    <div class="subsection">
        <p>DRV '봇' 시스템은 인간 DRV 플레이어를 대체하여, 플레이어가 미군 측을 조작하면서 Downtown을 혼자서 플레이할 수 있게 합니다.</p>
        <p>이 '봇'은 Douglas Bush가 그의 Red Storm을 위해 설계한 봇을 기반으로 하며, Antonio Pinar Peña와 Lee Brimmcombe-Wood가 설계한 Downtown 봇(BGG에서 이용 가능)에서 영감을 받았습니다. Downtown은 원래 Lee Brimmicombe-Wood가 설계했습니다.</p>
    </div>
</div>

<div class="section">
    <h2>1.2 구성요소</h2>
    <div class="subsection">
        <ul>
            <li>11" x 17" DRV '봇' 보조 카드 1개. 이 플레이어 보조 카드는 '봇'을 운영하는 데 필요한 모든 차트와 표를 포함합니다.</li>
            <li>#1 – #10으로 표시된 SAM 셋업 마커 10개. 이는 DRV SAM 사이트 설치를 돕습니다. 이를 제공하거나(또는 플렉시와 드라이 이레이즈 마커를 사용해야 합니다).</li>
        </ul>
    </div>
</div>

<h1>2. 황금 규칙</h1>

<div class="section golden-rule">
    <h2>2.1 황금 규칙</h2>
    <div class="subsection">
        <ul>
            <li><strong>'봇'은 규칙을 따릅니다 (거의)</strong>. '봇'은 다음 예외를 제외하고 모든 Downtown 규칙을 준수합니다:
                <ul>
                    <li>'봇'은 더미 MiG, 숨겨진 SAM, 또는 숨겨진 AAA를 사용하지 않습니다. 대신, SAM 사이트의 상태는 적절한 SAM 마커의 유형과 방향으로 표시됩니다.</li>
                    <li>'봇'은 비행대를 구매하지 않습니다. 대신, 비행대는 일반 비행대 마커에서 무작위로 생성됩니다. 시나리오 종료 시, DRV가 모든 실제 비행대에 대해 지출했을 MAP를 합계하고 그에 따라 미군 VP를 부여합니다.</li>
                    <li>'봇' MiG 조종사는 항상 베테랑입니다.</li>
                    <li>충돌 회피는 AAA와 DRV 비행대에 항상 적용됩니다 (즉, AAA는 DRV 비행대를 절대 공격하지 않습니다).</li>
                    <li>이착륙 시를 제외하고, DRV 비행대는 야간과 저고도와 초저고도 사이에 짙은 구름층이 있을 때 절대 초저고도로 비행하지 않습니다.</li>
                </ul>
            </li>
        </ul>
        <ul>
            <li><strong>플레이어는 규칙을 따릅니다 (거의)</strong>. 플레이어는 다음 하나의 예외를 제외하고 모든 Downtown 규칙을 준수합니다:
                <ul>
                    <li>플레이어는 일반 비행대 마커를 사용하지 않습니다.</li>
                </ul>
            </li>
        </ul>
        <ul>
            <li><strong>의심스러울 때는 무작위화하세요</strong>. '봇'이 여러 옵션 중에서 선택해야 하고 제공된 지침이 소진되었을 때마다, 한 옵션을 무작위로 선택하세요.</li>
            <li><strong>그냥 '봇'일 뿐입니다!</strong> 기억하세요, 당신은 카드보드 상대와 게임하고 있습니다. '봇'이 특히 어리석은 움직임을 하려고 한다고 생각되면 언제든지 '봇' 지침을 자유롭게 수정하세요.</li>
        </ul>
    </div>
</div>

<h1>3. 승리</h1>

<div class="section">
    <h2>3.1 승리</h2>
    <div class="subsection">
        <p>미군과 DRV 모두 정상적인 방식으로 VP를 획득합니다.</p>
        <p>시나리오 종료 시, DRV가 모든 실제 비행대에 지출한 총 MAP를 계산하세요; <span class="table-ref">🅠 종료 시 MAP</span>를 참조하세요. 이 합계를 시나리오 설치 지침과 비교하고 적절하게 미군 VP를 추가하세요. '봇'이 특정 시나리오에서 이용 가능했던 것보다 더 많은 MAP를 지출했다고 판명되면, 적어도 일부 항공기는 귀환했기를 바랍니다.</p>
    </div>
</div>

<h1>4. 셋업(Setup)</h1>

<div class="section">
    <h2>4.1 시나리오 선택</h2>
    <div class="subsection">
        <p>DRV '봇'은 원래 Downtown 시나리오 중 어느 것이든 플레이하는 데 사용할 수 있습니다.</p>
    </div>
</div>

<div class="section">
    <h2>4.2 DRV 방어 셋업</h2>
    <div class="note">
        <strong>참고:</strong> DRV '봇'은 인간 상대와 다른 세팅 절차를 사용합니다. 일반적으로 '봇'은 지도에 위치가 확인된 SAM을 배치하지 않고(몇 가지 시나리오 제외; 아래 시나리오별 지침 참조), AAA 집중구역을 업그레이드하지 않으며, 시나리오 시작 시 MiG를 구매하지 않습니다.
    </div>
    <div class="subsection">
        <ol>
            <li><strong>SAM 셋업 마커 배치:</strong>
                <ul>
                    <li>하이퐁(2410 또는 2411)이 가능한 목표가 아닌 경우: 하노이 시내(2028)의 4헥스 내에 마커 #1 – #5를 배치합니다.</li>
                    <li>하이퐁(2410 또는 2411)이 가능한 목표인 경우: 하노이 시내(2028)의 3헥스 내에 마커 #1 – #3을, 하이퐁(2410)의 3헥스 내에 마커 #4 – #5를 배치합니다.</li>
                    <li>시나리오 D14를 플레이하는 경우: 하노이 시내(2028)의 4헥스 내에 마커 #1 – #8을 배치합니다.</li>
                    <li>나머지 마커는 맵의 어디든지 배치합니다(아래 제한 사항 내에서).</li>
                </ul>
                <p><strong>SAM 셋업 제한:</strong> 모든 경우에 SAM 셋업 마커는 도시, 철도, 또는 고속도로 헥스의 2헥스 내에, 그리고 다른 모든 SAM 설치 마커로부터 최소 3헥스 떨어진 곳에 배치되어야 합니다. 가능한 미군 비행대 경로를 커버할 수 있는 논리적인 위치에 마커를 배치하도록 노력하세요.</p>
            </li>
            <li><strong>AAA 마커 배치:</strong>
                <ul>
                    <li>비활성 AAA 마커는 가능한 AAA 사이트를 나타냅니다(이를 위해 임의의 AAA 마커를 사용하세요; 활성화되면 적절한 AAA 마커로 교체됩니다). 셋업 시 배치되는 AAA 마커의 총 수는 <span class="table-ref">🅞 DRV 준비 표</span>에 표시됩니다. 잠재적 목표 헥스를 커버하도록 비활성 AAA 마커를 분배하되, 지도 상 AAA로 커버되지 않는 곳을 먼저, 그 다음 하노이나 하이퐁에 가장 가까운 곳을 우선합니다.</li>
                    <li><span class="red">'봇'은 지도 상 AAA 집중구역 업그레이드를 절대 구매하지 않습니다.</span></li>
                    <li><span class="table-ref">🅞 DRV 준비 표</span>에 표시된 대로 이용 가능한 파이어 캔 마커를 수집하고, 지금은 따로 둡니다.</li>
                </ul>
                <p class="note"><strong>참고:</strong> <span class="red">'봇'은 숨겨진 AAA 집중구역을 사용하지 않습니다.</span> AAA 마커 배치에 관해 봇을 위해 합리적인 선택을 하도록 최선을 다하세요.</p>
            </li>
            <li><strong>공격대 목표와 미군 비행대 선택:</strong> 시나리오 지침에 따라. 모든 미군 경로와 진입/이탈 헥스를 정상적으로 계획합니다.</li>
            <li><strong>SAM 경고 마커 배치:</strong>
                <ul>
                    <li>레이더 꺼짐 면의 SAM 경고 마커는 가능한 SAM 사이트를 나타냅니다. 셋업 시 배치되는 SAM 경고 마커의 총 수는 <span class="table-ref">🅞 DRV 준비 표</span>에 표시됩니다. 각 마커마다 1d10을 굴립니다; 굴린 SAM 셋업 마커의 2헥스 내에, 그리고 이미 맵에 있는 다른 SAM 경고 마커로부터 최소 1헥스 떨어진 곳에 마커를 배치합니다. 특정 SAM 셋업 마커에 대해 적법한 배치 헥스가 존재하지 않으면 재굴림합니다.</li>
                </ul>
                <p class="note"><strong>참고:</strong> <span class="red">'봇'은 숨겨진 SAM을 사용하지 않습니다.</span> 아래 특별 시나리오 셋업 지침에 표시되지 않는 한, 위치가 확인된 SAM은 맵에 배치되지 않습니다.</p>
            </li>
            <li><strong>일반 MiG 비행대 배치:</strong>
                <ul>
                    <li>일반 MiG 비행대는 가능한 MiG를 나타냅니다. 설치 시 배치되는 일반 MiG 비행대의 총 수는 <span class="table-ref">🅞 DRV 준비 표</span>의 최대 실제 비행대 열의 절반과 같으며, 소수점 이하는 버립니다. 조기 경보 표에 의해 DRV가 공중 비행대를 설치할 수 있다면, 무작위 활성 미군 진입 화살표에 더 가까운 개방된 비행장이나 공중 대기 지점 중 더 가까운 곳의 3헥스 내 중고도에 일반 비행대 1개를 배치합니다.</li>
                    <li>일반 DRV 비행대를 개방된 주요 비행장에 분배하되, 하노이나 하이퐁에 더 가까운 곳을 먼저, 비행장당 1개 비행대를 초과하지 않게 합니다. 모든 DRV 비행대는 준비 상태이고 탐지되지 않은 상태로 설치됩니다. 둘 이상의 활주로가 있으면 방향을 무작위로 선택합니다.</li>
                </ul>
                <p class="note"><strong>참고:</strong> 각 일반 비행대는 플레이 중에 실제 비행대 또는 더미 비행대로 공개되고 제거됩니다. 공개되기 전까지는 움직임 목적으로 일반 비행대를 실제인 것처럼 취급합니다.</p>
            </li>
            <li><strong>시나리오 설치 정상 진행</strong></li>
        </ol>
    </div>
</div>

<div class="section">
    <h2>4.3 시나리오별 준비 지침</h2>
    <div class="subsection">
        <ul>
            <li><strong>D1:</strong> SAM 셋업 마커를 배치하지 말고 SAM 경고 마커 배치를 위해 굴리지 마세요. 대신, 모든 SAM 경고 마커의 위치는 SSR 1을 참조하세요.</li>
            <li><strong>D2:</strong> SSR 3에 따라, 0918의 2헥스 내에 2개를 초과하지 않는 비활성 AAA 마커를 배치합니다.</li>
            <li><strong>D3:</strong> SAM과 MiG 모두 정상적으로 배치합니다. 첫 번째 SAM이나 MiG가 활성화되는 순간, 주사위 하나를 굴립니다: 1-5면 'SAM 날'이 되고, 6-10이면 'MiG 날'이 됩니다. 일단 결정되면, 'SAM 날'이면 모든 DRV 비행대를(일반과 실제 모두) 제거하고, 'MiG 날'이면 모든 SAM 마커를(활성과 비활성 모두) 제거합니다.</li>
            <li><strong>D6:</strong> 고강도 AAA 집중구역을 초래하는 <span class="table-ref">🅘 AAA & 파이어 캔 활성화 표</span> 굴림을 무시하고; 대신 재굴림하여 저강도 또는 중강도 AAA를 생성합니다.</li>
            <li><strong>D10:</strong> 주간 공격대 중에만 MiG 비행대를 배치하고 생성합니다. 셋업 중에, 처음 8개의 SAM 경고 마커를 레이더 켜짐 상태의 위치 확인된 SAM 마커로 교체합니다. SSR 6에 따라, 플레이어는 이 중 3개를 목표로 지정합니다. 그 다음, 나머지 22개의 SAM 경고 마커를 정상적으로 배치합니다.</li>
            <li><strong>D12:</strong> SAM 배치를 위해 굴리지 마세요. 대신, 헥스 0148의 4헥스 내에 SAM 경고 마커 2개를 배치합니다.</li>
            <li><strong>D14:</strong> 하노이의 4헥스 내에 SAM 셋업 마커 #1 – #8을 배치합니다.</li>
            <li><strong>D16:</strong> 셋업 중에, 처음 7개의 SAM 경고 마커를 레이더 켜짐 상태의 위치 확인된 SAM 마커로 교체합니다. 이것들이 SSR 5에 따라 미군 F-111 SEAD 비행대가 공격할 수 있는 유일한 SAM 사이트입니다.</li>
        </ul>
    </div>
</div>

<h1>5. 플레이 순서</h1>

<div class="section">
    <p>아래에 명시된 경우를 제외하고는 플레이 순서의 모든 단계를 정상적으로 실행합니다:</p>
</div>

<div class="section">
    <h2>5.1 무작위 사건</h2>
    <div class="subsection">
        <p>아래에 명시되지 않는 한 각 무작위 사건을 정상적으로 실행합니다: <span class="table-ref">무작위 이벤트</span></p>
        <ul>
            <li><strong>신속 대응 경보:</strong> 활성화된 MiG 비행대 수가 최대 실제 비행대와 같거나 지도 상 일반 비행대가 최대 일반 비행대와 같지 않는 한(<span class="table-ref">🅞 DRV 준비 표</span> 참조), 무작위 개방 비행장에 무작위 방향으로 일반 DRV 비행대를 배치합니다.</li>
            <li><strong>AAA 매복:</strong> MiG처럼 <span class="table-ref">🅜 표적 선택 표</span>를 사용하여 비행대를 선택합니다.</li>
            <li><strong>날씨 악화:</strong> 날씨 카운터를 무작위로 선택합니다.</li>
            <li><strong>DRV 관제사의 신경 쇠약:</strong> 먼저 무질서 상태인 실제 DRV 비행대 중 무작위로 하나를; 그 다음 일반 DRV 비행대 중 무작위로 하나를 선택합니다.</li>
        </ul>
    </div>
</div>

<div class="section">
    <h2>5.2 재밍 페이즈</h2>
    <div class="subsection">
        <p>변경사항 없음.</p>
    </div>
</div>

<div class="section">
    <h2>5.3 탐지 페이즈</h2>
    <div class="subsection">
        <p>변경사항 없음.</p>
    </div>
</div>

<div class="section">
    <h2>5.4 이동 페이즈</h2>
    <div class="subsection">
        <h3>방어 원형진:</h3>
        <ul>
            <li>CAP 태스크를 받은 3개 이상의 미군 비행대의 5헥스 내에 있는 무질서 상태가 아닌 DRV 비행대는 방어 원형진에 진입합니다. 3개 이상의 미군 CAP 비행대의 5헥스 내에 있지 않거나 무질서 상태인 DRV 비행대는 방어 원형진을 떠납니다.</li>
        </ul>

        <h3>이동 순서:</h3>
        <ul>
            <li>미군 비행대의 5헥스 내에 무질서 상태가 아닌 DRV 비행대가 있으면, DRV가 먼저 이동하기로 선택합니다. 그렇지 않으면, 플레이어가 먼저 이동합니다.</li>
        </ul>

        <h3>일반 DRV 비행대 활성화:</h3>
        <ul>
            <li><span class="table-ref">🅐 비행대 활성화 표</span>를 사용하여 일반 DRV 비행대 활성화를 확인합니다.</li>
            <li>일반 비행대가 활성화될 때:
                <ul>
                    <li><span class="table-ref">🅝 DRV 비행대 선택 표</span>를 사용하여 항공기 유형과 비행대 내 항공기 수를 결정합니다.</li>
                    <li>일반 비행대 마커를 적절한 DRV 비행대 마커로 교체합니다.</li>
                    <li>DRV 비행대 로그 시트에 비행대 정보를 추가합니다. 모든 DRV 조종사는 베테랑입니다.</li>
                    <li>굴림 결과가 검은 상자에 흰 텍스트를 보여주거나 활성화된 DRV 비행대의 총 수가 <span class="table-ref">🅞 DRV 준비 표</span>에 표시된 최대 실제 비행대와 같아지면, 이것이 활성화될 마지막 일반 DRV 비행대입니다. 맵에서 남은 모든 일반 DRV 비행대를 제거하고(더미로 공개됨) 더 이상 배치하지 않습니다.</li>
                </ul>
            </li>
        </ul>

        <h3>DRV 비행대 이동:</h3>
        <ul>
            <li><span class="table-ref">🅑 이동 페이즈</span>를 사용하여 DRV 비행대 이동 순서를 결정합니다.</li>
            <li>활성 비행대가 강제로 취해야 할 행동이 있는지 <span class="table-ref">🅒 비행대 행동 — 주요 행동</span>을 확인합니다.</li>
            <li><span class="table-ref">🅓 비행대 행동 — 전투 행동</span>을 사용하여 활성 비행대가 취할 행동을 결정합니다.</li>
            <li><span class="table-ref">🅕 비행대 행동 — 교전 행동</span> 또는 <span class="table-ref">🅖 비행대 행동 — 비전투 행동</span> 중 하나를 사용하여 활성 비행대가 어떻게 이동할지 결정합니다.</li>
            <li>모든 DRV 비행대를 이동시킬 때 <span class="table-ref">🅗 일반 비행대 행동</span>을 지침으로 사용합니다.</li>
        </ul>

        <h3>이동하는 미군 비행대에 대한 활성 SAM 발사:</h3>
        <ul>
            <li>활성 SAM이 이동하는 미군 비행대를 발사하는지와 몇 개의 미사일을 발사하는지 확인하려면 <span class="table-ref">🅛 SAM 행동 표</span>를 참조하세요. SAM 탄약 추적은 6.3을 참조하세요.</li>
        </ul>

        <h3>ARM 발사:</h3>
        <ul>
            <li>활성 SAM은 ARM 발사에 의해 목표가 되면 레이더를 켜진 상태로 유지하려고 시도합니다. 목표가 된 SAM이 ARM 사기 체크[18.74]에 실패하면, SAM 위에 레이더 종료 마커를 놓되 활성 상태를 나타내기 위해 레이더 켜짐 면을 위로 두어야 합니다.</li>
        </ul>

        <h3>AAA 활성화:</h3>
        <ul>
            <li>미군 비행대가 각 비활성 AAA 마커의 1헥스 내로 이동할 때마다 AAA 활성화 체크를 합니다. <span class="table-ref">🅘 AAA & 파이어 캔 활성화 표</span>를 참조하세요.</li>
        </ul>

        <h3>파이어 캔 활성화:</h3>
        <ul>
            <li>미군 비행대가 이미 파이어 캔이 없고 파이어 캔에 인접하지 않은 활성 AAA 마커나 인쇄된 AAA 집중구역의 2헥스 내로 이동할 때마다 파이어 캔 활성화 체크를 합니다. <span class="table-ref">🅘 AAA & 파이어 캔 활성화 표</span>를 참조하세요. 주어진 시나리오에 대해 이용 가능한 모든 파이어 캔이 배치되었다면, 추가 배치 지침을 모두 무시합니다.</li>
        </ul>

        <h3>이동하는 미군 비행대에 대한 AAA 발사:</h3>
        <ul>
            <li>이동하는 미군 비행대에 대한 AAA와 파이어 캔 발사는 <span class="table-ref">🅙 AAA/파이어 캔 행동 표</span>를 참조하세요.</li>
        </ul>
        <p class="note"><strong>참고:</strong> AAA와 파이어 캔은 DRV 비행대를 절대 공격하지 않습니다.</p>

        <h3>[선택사항] 비활성 SAM 발사 후 락온 발사:</h3>
        <ul>
            <li>탐지된 미군 비행대가 비활성 SAM의 5헥스 내로 이동할 때마다 확인합니다. <span class="table-ref">🅩 발사 후 락온 표</span>를 참조하세요.</li>
        </ul>
    </div>
</div>

<div class="section">
    <h2>5.5 연료 페이즈</h2>
    <div class="subsection">
        <p>변경사항 없음.</p>
    </div>
</div>

<div class="section">
    <h2>5.6 SAM 위치 확인 페이즈</h2>
    <div class="subsection">
        <p>미군 비행대가 비활성 SAM을 성공적으로 위치 확인하면, 진행하기 전에 SAM 활성화 체크를 실시합니다. <span class="table-ref">🅚 SAM 활성화 표</span>를 참조하세요.</p>
    </div>
</div>

<div class="section">
    <h2>5.7 추적 페이즈</h2>
    <div class="subsection">
        <p>변경사항 없음.</p>
    </div>
</div>

<div class="section">
    <h2>5.8 SAM 표적 획득 페이즈</h2>
    <div class="subsection">
        <p>미군 비행대의 12헥스 내에 있는 각 비활성 SAM에 대해 활성화를 확인합니다. <span class="table-ref">🅚 SAM 활성화 표</span>를 참조하세요. 그 다음, 모든 활성 SAM은 미군 비행대를 표적 획득하려고 시도합니다. 이 페이즈에 활성화된 SAM은 12헥스 내에 탐지된 미군 비행대가 있다면 신속 표적 획득을 시도합니다. <span class="table-ref">🅜 표적 선택 표</span>를 참조하세요. 모든 경우에 목표 미군 비행대가 고고도에 있으면 거리에 1을 추가합니다.</p>
    </div>
</div>

<div class="section">
    <h2>5.9 관리 페이즈</h2>
    <div class="subsection">
        <ul>
            <li>탄약이 없는 활성 SAM과 SAM 경고 마커는 레이더를 끕니다.</li>
            <li>활성 MiG 비행대의 총 수가 최대 실제 비행대와 같거나 지도 상 일반 MiG 비행대의 총 수가 최대 일반 비행대와 같아질 때까지(<span class="table-ref">🅞 DRV 준비 표</span> 참조), 일반 DRV 비행대가 맵에 추가되는지 굴림합니다. <span class="table-ref">🅔 일반 비행대 생성</span>을 참조하세요.</li>
        </ul>
    </div>
</div>

<h1>6. 기타사항</h1>

<div class="section">
    <h2>6.1 표적 선택</h2>
    <div class="subsection">
        <p>활성 MiG나 SAM이 미군 비행대를 목표로 해야 할 때마다, <span class="table-ref">🅜 표적 선택 표</span>를 사용합니다:</p>
        <ol>
            <li><strong>1단계.</strong> 적절한 열의 맨 위에서 시작하여 아래로 읽습니다. 그 열에 점이 있는 각 행에 대해, 일치하는 미군 비행대를 찾습니다. 일치하는 비행대가 없으면, 그 행을 건너뛰고 다음으로 계속합니다. 이 조건을 만족하는 비행대가 하나뿐이면, 그 미군 비행대를 목표로 합니다. 그렇지 않으면,</li>
            <li><strong>2단계.</strong> 둘 이상의 비행대가 일치하면, 열을 따라 계속 내려가서 충족되는 다음 조건으로 갑니다. 미군 비행대와 일치하지 않는 조건들을 계속 건너뜁니다. 원래 조건과 새 조건을 모두 만족하는 비행대가 하나뿐이면, 그것을 목표로 합니다.</li>
            <li><strong>3단계.</strong> 이 과정을 계속하여, 아래의 각 행을 확인하고 만족하는 모든 조건을 적용하여, 단일 미군 비행대가 선택될 때까지 합니다.</li>
            <li><strong>4단계.</strong> 선택될 각 목표에 대해 1단계부터 이 과정을 반복합니다.</li>
        </ol>
    </div>
</div>

<div class="section">
    <h2>6.3 SAM 마커</h2>
    <div class="subsection">
        <p>기록 보관을 용이하게 하기 위해, SAM 마커의 유형과 방향을 사용하여 활성화, 위치 상태, 및 탄약 고갈을 나타냅니다. <span class="table-ref">🅟 SAM & AAA 지도 상 마커 범례</span>를 참조하세요.</p>
        <ul>
            <li>레이더 꺼짐 면의 SAM 경고 마커는 비활성 SAM을 나타냅니다. 활성화될 때까지 발사하거나 표적 획득을 시도할 수 없습니다. 일단 활성화되면, 탄약이 떨어질 때까지 레이더를 켜둔 다음, 레이더를 끕니다.</li>
            <li>레이더 켜짐 면의 SAM 경고 마커는 위치가 확인되지 않은 활성 SAM을 나타냅니다. 처음 배치될 때, SAM 사이트는 전체 3개의 미사일을 보유합니다(SSR에 의해 수정되지 않는 한). 오른쪽으로 90º 회전시키면 SAM에 2개의 미사일이 남음을 나타냅니다; 180º 회전시키면 1개의 미사일이 남음; 270º 회전시키면 탄약이 다했음을 나타냅니다.</li>
            <li>레이더 켜짐 면의 SAM 마커는 위치가 확인된 활성 SAM을 나타냅니다. 탄약 고갈을 나타내기 위해 위와 같이 마커를 회전시킵니다.</li>
            <li>탄약이 없는 SAM 경고나 SAM 마커는 다음 관리 페이즈에 레이더를 끕니다.</li>
        </ul>
        <p class="note"><strong>[선택사항]</strong> SAM 탄약을 추적하는 대신, {3}을 사용하여 공대공 무기처럼 탄약 고갈을 굴립니다. 일제 사격을 발사하는 경우, 고갈 굴림을 -3으로 보정합니다.</p>
    </div>
</div>

</main>
<!-- Floating Action Button and Modal -->
<div id="fab" class="fab">+</div>
<div id="sopModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-dialog">
        <span id="modalTitle">플레이 순서</span>
        <span id="closeModal" class="close-button" role="button" aria-label="Close">&times;</span>
    </div> 
    <div class="modal-content">
        <iframe src="sop.html" frameborder="0" style="width: 100%; height: 100%;"></iframe>
    </div>
</div>

<!-- Generic Modal for Table References -->
<div id="refModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="refModalTitle">
    <div class="modal-dialog">
        <span id="refModalTitle"></span>
        <span class="close-button" role="button" aria-label="Close">&times;</span>
    </div>
    <div class="modal-content" id="refModalContent">
        <!-- Content will be injected here -->
    </div>
</div>

<script>
    // downtown_bot_aid_KOR_Printversion_dice3.html의 내용을 담는 데이터 객체
    // 이 객체의 내용을 수정하여 모달에 표시될 정보를 관리할 수 있습니다.
    const refContentData = {
        "무작위 이벤트": `<img src="random.png" alt="무작위 이벤트 표" style="width: 100%; height: auto;">`,
        "🅐 비행대 활성화 표": `<p>DRV 비행대는 활성화될 때까지 일반 비행대 마커를 사용합니다. 일반 DRV 비행대는 다음 상황에서 활성화를 확인합니다:</p><ul><li>육안으로 식별되었을 때 [10.4]</li><li>공대공 전투를 시도하거나 성공적으로 교전했을 때</li><li><span class="red-bold-text">🅓 비행대 행동 — 전투 행동</span>에서 교전 결과를 받았을 때</li></ul><div class="highlight"><strong>비행대 활성화 확인</strong> <span class="dice-formula">(1d10)</span>: <br>≤ 5 <span class="result">실제 비행대</span>; ≥ 6 <span class="result">더미</span></div><p><strong>실제 비행대인 경우:</strong> 비행대를 활성화. <span class="red-bold-text">🅝 DRV 비행대 선택 표</span>를 참조.</p><p><strong>더미인 경우:</strong> 일반 비행대 마커를 제거.</p>`,
        "🅑 이동 페이즈": `<p>무질서 상태가 아닌 DRV 비행대가 US 비행대로부터 5헥스 이내에 있다면, DRV가 먼저 이동합니다. 그렇지 않으면 US가 먼저 이동합니다.</p><div class="note">무질서 상태가 아닌 DRV 비행대(주간인 경우)가 3개 이상의 US CAP 비행대로부터 5헥스 이내에 있으면 방어 원형진에 진입합니다. 무질서 상태 비행대와 3개 이상의 US CAP 비행대로부터 5헥스 이내에 있지 않은 비행대는 방어 원형진에서 벗어납니다.</div><p><strong>DRV 비행대를 다음 순서로 이동:</strong></p><ol><li>활성화된 DRV 비행대, US 비행대에 가장 가까운 것부터</li><li>일반 DRV 비행대, ID 문자 순서로, 탐지된 것부터</li></ol>`,
        "🅒 비행대 행동 — 주요 행동": `<p>다음 조건 중 하나라도 적용되면(순서대로), 다음과 같이 이동합니다:</p><div class="highlight">빨간색: 지시사항을 수행한 후 멈춥니다. <br>검은색: 지시사항을 수행한 후 <span class="red-bold-text">🅓 비행대 행동 — 전투 행동</span>으로 이동합니다.</div><table class="table"><tbody><tr><th>조건</th><th>행동</th></tr><tr><td><span class="condition">기동 마커</span></td><td>전투 쓰로틀. MF의 ½을 소모하여 기동 마커를 제거.</td></tr><tr><td><span class="condition">BVR 회피 마커</span></td><td>전투 쓰로틀. 1 MP를 소모하여 BVR 회피 마커를 제거.</td></tr><tr><td><span class="condition2">손상된 항공기</span></td><td>비행대 내 모든 항공기가 손상된 경우: 비행대 작전 중지. 아래 비행대 작전 중지 지침을 따름.</td></tr><tr><td><span class="condition2">무력화된 항공기, 비행대 작전 중지, 또는 Winchester</span></td><td>전투 쓰로틀. 초저고도로 강하 [☾/⛅: 저고도]. 개방된 비행장 또는 중국 완충 지대(Chinese Buffer Zone) 중 더 가까운 곳을 향해 이동.</td></tr><tr><td><span class="condition2">무질서 상태</span></td><td>집결 지점에 인접하지 않은 경우: 대시 쓰로틀. 초저고도로 강하 [☾/⛅: 저고도]하고 가장 가까운 개방된 비행장 또는 공중 대기 지점(Orbit point)에 최대한 가깝게 이동.</td></tr><tr><td><span class="condition2">비행장에서 준비 완료</span></td><td>이륙. 다음 턴에 전진하며 초저고도에 남아 있음.</td></tr></tbody></table>`,
        "🅓 비행대 행동 — 전투 행동": `<p>이동하는 각 DRV 비행대에 대해 <span class="dice-formula">1d10</span>을 굴립니다:</p><div class="highlight">≤ 5이고 5헥스 이내에 탐지된 US 비행대가 있는 경우: <span class="result">교전</span>.<br>-<span class="red-bold-text">  🅕 교전 행동</span> 참조.<br><br>≥ 6이거나 5헥스 이내에 탐지된 US 비행대가 없는 경우: <span class="result">교전 없음</span>. <br>-<span class="red-bold-text">  🅖 비전투 행동</span> 참조.</div><p><strong>보정 수치 </strong><span class="modifier">DRV 비행대가 탐지되지 않은 경우: -2</span></p>`,
        "🅔 일반 비행대 생성": `<p>각 관리 페이즈마다, 최대 실제 비행대 또는 최대 일반 비행대 중 하나가 충족될 때까지, <span class="dice-formula">1d10</span>을 굴립니다:</p><table class="table"><tbody><tr><th>주사위</th><th>결과</th></tr><tr><td>≤ 4 또는 지도에 일반 DRV가 없는 경우</td><td>US 비행대에 가장 가까운 DRV가 없는 개방된 비행장에 일반 비행대 1개를 배치.</td></tr><tr><td>5-7</td><td>US 비행대에 가장 가까운 기존의 탐지되지 않은 비행대와 함께 일반 비행대 1개를 배치(있는 경우).</td></tr><tr><td>≥ 8</td><td>이번 턴에는 일반 비행대를 배치하지 않음.</td></tr></tbody></table>`,
        "🅕 비행대 행동 — 교전 행동": `<p><strong>공대공 전투 시도:</strong></p><ol><li>표적 선택: <span class="red-bold-text">🅜 표적 선택 표</span> 참조.</li><li>다음과 같이 이동:<ol><li>교전에 필요한 경우 대시 쓰로틀, 그렇지 않으면 전투 쓰로틀 사용. 가능하다면 같은 고도에서 후방 반구로 US 비행대 헥스에 진입하도록 이동. 교전 시도; 허용되면 슬래시 공격 수행</li><li>교전에 성공하면 공대공 전투를 해결. 가능한 모든 사격 수행: 기관포 먼저, 그 다음 IRM(사용 가능한 경우)</li><li>교전에 실패하면 남은 MP를 사용하여 초저고도로 강하 [☾/⛅: 저고도]하고 전진</li></ol></li></ol>`,
        "🅖 비행대 행동 — 비전투 행동": `<p><span class="dice-formula">1d10</span>을 굴리고 다음과 같이 이동합니다:</p><table class="table"><tbody><tr><th>주사위</th><th>행동</th></tr><tr><td>≤ 4</td><td><strong>접근.</strong> 1) 전투 쓰로틀. 2) 표적 선택: <span class="red-bold-text">🅜 표적 선택 표</span> 참조. 3) 가능하다면 표적 고도에 맞춤. 4) 표적 비행대 방향으로 이동하되, 5헥스보다 가깝게 가지 않음. 최대한 전방 호 안에 있어야 함</td></tr><tr><td>5-8</td><td><strong>위치 유지.</strong> 1) 전투 쓰로틀. 2) 저고도로 이동. 3) 1MP 만큼 전진. 4) 1 MP 동안 좌측으로 60도 선회. 모든 MP를 사용할 때까지 반복.</td></tr><tr><td>≥ 9</td><td><strong>회피.</strong> 1) 전투 쓰로틀. 2) 가장 가까운 US 비행대로부터 멀어지며, 자유 강하로 초저고도로 강하 [☾/⛅: 저고도].</td></tr></tbody></table><p><strong>보정 수치 </strong><span class="modifier">DRV 비행대가 탐지되지 않은 경우: -2</span></p>`,
        "🅗 일반 비행대 행동": `<ul><li>일반 비행대는 모든 고도에서 <strong>전투 쓰로틀 3</strong>, <strong>대시 쓰로틀 4</strong>를 사용합니다.</li><li>이탈하는 경우가 아니라면, DRV 비행대는 항상 플레이 구역을 벗어나지 않도록 선회합니다.</li><li>DRV 비행대는 초저고도에 있을 때 능선을 피하기 위해 상승합니다.</li><li>DRV 비행대는 마지막 연료 단위를 자발적으로 사용하지 않습니다.</li><li>DRV 비행대는 무질서 상태이거나 작전 중지된 경우 교전 해제를 시도합니다.</li><li>DRV 비행대는 선택할 수 있다면 방어자로서의 교전을 거부합니다.</li><li>착륙하는 경우가 아니라면, DRV 비행대는 야간이나 초저고도와 저고도 사이에 조밀한 구름층이 있을 때 초저고도로 하강하지 않습니다 [☾/⛅: 저고도].</li></ul>`,
        "🅘 AAA & 파이어 캔 활성화 표": `<p>비활성 AAA 마커의 1헥스 이내로 이동하는 저고도 이상의 각 US 비행대에 대해 한 번 확인합니다.</p><div class="highlight"><strong>AAA 활성화 확인</strong> <span class="dice-formula">(1d10)</span>: ≤ 5 <span class="result">실제 AAA</span>; 6-8 <span class="result">효과 없음</span>; ≥ 9 <span class="result">더미</span></div><table class="table"><tbody><tr><th>결과</th><th></th></tr><tr><td>≤ 4</td><td><strong>실제 AAA: </strong> 1d10 굴림: ≤ 6 저강도; 7-9 중강도; 10 고강도</td></tr><tr><td>5-8</td><td><strong>효과 없음(NE): </strong>비활성 AAA 경고 마커를 유지합니다.</td></tr><tr><td>≥ 9</td><td><strong>더미 AAA: </strong> AAA 경고 마커를 제거합니다.</td></tr></tbody></table><p>파이어 캔이 없는 활성 AAA의 2헥스 이내로 이동하는 각 US 비행대에 대해 한 번 확인합니다.</p><div class="highlight"><strong>파이어 캔 활성화 확인</strong> <span class="dice-formula">(1d10)</span>: ≤ 3 <span class="result">파이어 캔</span>; ≥ 4 <span class="result">효과 없음</span></div><table class="table"><tbody><tr><th>결과</th><th></th></tr><tr><td>≤ 4</td><td><strong>실제 파이어 캔: </strong> 사용 가능한 파이어 캔을 배치하고 유발한 US 비행대에 사격합니다.</td></tr><tr><td>5-8</td><td><strong>효과 없음(NE): </strong>파이어 캔을 놓지 않습니다.</td></tr></tbody></table><p><strong>보정 수치 </strong><span class="modifier">5헥스 이내에 파이어 캔이 있는 경우: +1</span></p>`,
        "🅙 AAA/파이어 캔 행동 표": `<ul><li>AAA는 이동 페이즈 중 가능한 한 빠른 시점에 사거리 내의 모든 US 비행대에 사격합니다.</li><li>파이어 캔은 이동 페이즈 중 가능한 한 빠른 시점에 사격합니다.</li><li>DRV 비행대는 무시합니다(모든 고도에서 충돌 회피[14.74]를 적용합니다).</li></ul>`,
        "🅚 SAM 활성화 표": `<p>비활성 SAM은 활성화될 때까지 레이더 오프 SAM 경고 마커를 사용합니다. 비활성 SAM은 다음 상황에서 활성화를 확인합니다:</p><ul><li>어떤 수단으로든 위치가 파악되었을 때.</li><li>SAM 표적 획득 페이즈 중, US 비행대로부터 12헥스 이내에 있을 때.</li><li>[선택사항] 이동 페이즈 중: <span class="red-bold-text">🅩 발사 후 락온 표</span>를 참조하세요.</li></ul><div class="highlight"><strong>SAM 활성화 확인</strong> <span class="dice-formula">(1d10)</span>: ≤ 4 <span class="result">실제 SAM</span>; 5-8 <span class="result">효과 없음</span>; ≥ 9 <span class="result">더미 SAM</span></div><table class="table"><tbody><tr><th>결과</th><th></th></tr><tr><td>≤ 4</td><td><strong>실제 SAM: </strong> SAM 경고 마커를 뒤집어서 레이더 시작(Radar ON)면으로 놓습니다. 이제 레이더는 활성화 상태입니다.</td></tr><tr><td>5-8</td><td><strong>효과 없음(NE): </strong>비활성 SAM 경고 마커를 유지합니다. 이번 턴에는 SAM 활성화 확인을 하지 않습니다</td></tr><tr><td>≥ 9</td><td><strong>더미 SAM: </strong> SAM 경고 마커를 제거합니다.</td></tr></tbody></table>`,
        "🅛 SAM 행동 표": `<p><strong>이동 페이즈:</strong> 탐지된 US 비행대가 자신을 표적 획득한 SAM의 8헥스* 이내에서 MP를 소모할 때마다 사격 확인을 합니다. 여러 SAM이 한 US 비행대의 표적을 획득한 경우, 가장 가까운 SAM만 확인(동률이면 ID 알파벳 순서로 결정)</p><div class="highlight"><strong>SAM 사격 확인</strong> <span class="dice-formula">(1d10)</span>: > US 비행대까지의 거리 <span class="result">사격</span>; ≤ US 비행대까지의 거리 <span class="result">사격 안 함</span></div><p><strong>보정 수치 </strong><span class="modifier">SAM이 완전 표적 획득을 한 경우: +2</span></p><p class="note">*표적까지의 거리를 계산할 때, 표적이 고고도에 있으면 거리에 1을 더합니다.</p><table class="table"><tbody><tr><th>결과</th><th></th></tr><tr><td><strong>사격 발생 O</strong></td><td> 표적 획득된 US 비행대에 SAM(지대공 미사일) 발사 공격을 수행. SAM 발사 확인 주사위 굴림이 짝수면: 가능하면 일제 사격(salvo)을 가합니다. SAM 발사 확인 주사위 굴림이 홀수면: 단일 미사일을 발사합니다.</td></tr><tr><td><strong>사격 발생 X</strong></td><td>SAM 사격을 수행하지 않습니다. 만약 US 항공기(동일한 항공기 포함)가 8 헥스 이내에서 다시 MP를 소모하면 SAM은 또 다른 시도를 할 수 있습니다.</td></tr></tbody></table><p><strong>ARM 사격: </strong> 탐지 상태 US 비행대가 ARM 사격을 하면, 모든 SAM은 레이더를 켠 상태를 유지하려고 합니다</p><p><strong>SAM 표적 획득 페이즈: </strong>US 비행대의 12 헥스 내에 있는 비활성 SAM의 활성화 여부를 확인: <span class="red-bold-text">🅚 SAM 활성화 테이블</span> 참조합니다. 그리고 모든 활성 SAM은 US 비행대 표적 획득을 시도합니다. 이번 턴에 활성화된 SAM도 탐지 상태 US 비행대를 대상으로 신속 표적 획득을 시도할 수 있습니다 [15.31] SAM들은 ID-문자 순서대로 탐지 시도를 합니다. <span class="red-bold-text">🅜 타겟 선택 테이블</span>을 참조하여 타겟을 선택하세요.</p>`,
        "🅜 표적 선택 표": `<p>다음 조건의 US 비행대를 선택합니다:</p><table class="table"><tbody><tr><th>행동 유닛이 SAM인 경우</th><td>• 행동하는 SAM에게 표적 획득되었고 8헥스 이내에 있는 경우<br>• 탐지 상태 비행대<br>• 적재 상태(Laden)<br>• 표적 획득 마커가 가장 적은 비행대<br>• 가장 가까운 비행대<br>• MiG의 5헥스 이내에 있지 않은 비행대<br>• 손상되거나 무력화된 항공기가 있는 US 비행대<br>• 남은 US 비행대 중에서 무작위 선택</td></tr><tr><th>행동 유닛이 MiG인 경우</th><td>• 탐지 상태 비행대<br>• 가장 낮은 고도대역에 위치한 비행대<br>• 적재 상태(Laden)<br>• 표적 획득 마커가 가장 적은 비행대<br>• 가장 가까운 비행대<br>• 손상되거나 무력화된 항공기가 있는 US 비행대<br>• 남은 US 비행대 중에서 무작위 선택</td></tr></tbody></table>`,
        "🅝 DRV 비행대 선택 표": `<p>일반 DRV 비행대 활성화 시 <span class="dice-formula">1d10</span>을 굴립니다. 모든 DRV 조종사는 베테랑입니다. 시나리오 종료 시, US VP를 추가합니다: <span class="red-bold-text">🅠 종료 시 MAP</span>를 참조.</p><table class="table"><tbody><tr><th>시나리오</th><th><span class="aircraft-type">MiG-17F</span></th><th><span class="aircraft-type">MiG-19S</span></th><th><span class="aircraft-type">MiG-21F-13</span></th><th><span class="aircraft-type">MiG-21PF</span></th><th><span class="aircraft-type">MiG-21PFM</span></th><th><span class="aircraft-type">MiG-21MF</span></th></tr><tr><td>D1</td><td>1-2 (x2), 3-4 (x3), 5-10 (x4)</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>D2</td><td>1-2 (x2), <span style="background-color: black; color: white;"><strong>3-10</strong></span> (x4)</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>D3</td><td>1 (x2), 2 (x3), 3-6 (x4)</td><td></td><td>7-8 (x2), 9 (x3), 10 (x4)</td><td></td><td></td><td></td></tr><tr><td>D4/D5</td><td>1 (x2), 2 (x3), 3-4 (x4)</td><td></td><td>5 (x2), 6 (x3), 7 (x4)</td><td>8 (x2), 9 (x3), 10 (x4)</td><td></td><td></td></tr><tr><td>D6</td><td>1-4 (x2), <span style="background-color: black; color: white;"><strong>5</strong></span> (x4)</td><td></td><td></td><td><span style="background-color: black; color: white;"><strong>6-10</strong></span> (x2)</td><td>5 (x2), 6 (x3), 7 (x4)</td><td>8 (x2), 9 (x3), 10 (x4)</td></tr><tr><td>D7/D8</td><td>1 (x2), 2 (x3), 3-4 (x4)</td><td></td><td></td><td>5-7 (x2), 8-9 (x3), 10 (x4)</td><td></td><td></td></tr><tr><td>D9</td><td>1 (x2), 2 (x3), 3-4 (x4)</td><td></td><td>5 (x2), 6 (x3)</td><td>7-8 (x2), 9 (x3), 10 (x4)</td><td></td><td></td></tr><tr><td>D10/D11</td><td>1 (x2), 2 (x3), 3 (x4)</td><td>4 (x3)</td><td></td><td></td><td>5 (x2), 6 (x3), 7 (x4)</td><td>8 (x2), 9 (x3), 10 (x4)</td></tr><tr><td>D12</td><td>1 (x2), <span style="background-color: black; color: white;"><strong>2-4</strong></span> (x4)</td><td><span style="background-color: black; color: white;"><strong>5</strong></span> (x2), <span style="background-color: black; color: white;"><strong>6</strong></span> (x3)</td><td></td><td></td><td><span style="background-color: black; color: white;"><strong>7-10</strong></span> (x2)</td><td></td></tr><tr><td>D13</td><td>1 (x2), 2 (x3), 3 (x4)</td><td>4 (x3)</td><td></td><td></td><td>5-6 (x2), 7 (x3)</td><td>8 (x2), 9 (x3), 10 (x4)</td></tr><tr><td>D14/D16</td><td></td><td></td><td></td><td></td><td></td><td>1-10 (x1 (야간))</td></tr><tr><td>D15</td><td></td><td></td><td></td><td></td><td></td><td>1-5 (x2), 6-8 (x3), 9-10 (x4)</td></tr></tbody></table><div class="note">1-2 : 주사위 굴림 범위 / x4 : 비행대 내 항공기 수 / <span style="background-color: black; color: white;"><strong>5-10</strong></span> : 이것 이후 더 이상 활성화 없음; 남은 모든 일반 비행대 제거</div>`,
        "🅞 DRV 준비 표": `<table class="table"><tbody><tr><th>시나리오</th><th>SAM 경고 마커 준비</th><th>AAA 마커 준비</th><th>사용 가능한 파이어 캔</th><th>최대 일반 비행대</th><th>최대 실제 비행대</th></tr><tr><td>D1</td><td>11*</td><td>5</td><td>4</td><td>3</td><td>1</td></tr><tr><td>D2</td><td>—</td><td>3*</td><td>-</td><td>4</td><td>2</td></tr><tr><td>D3</td><td>22*</td><td>8</td><td>8</td><td>5</td><td>3</td></tr><tr><td>D4</td><td>26</td><td>5</td><td>8</td><td>5</td><td>2</td></tr><tr><td>D5</td><td>30</td><td>7</td><td>9</td><td>6</td><td>3</td></tr><tr><td>D6</td><td>6</td><td>4*</td><td>2</td><td>-</td><td>-</td></tr><tr><td>D7</td><td>30</td><td>8</td><td>10</td><td>5</td><td>2</td></tr><tr><td>D8</td><td>30</td><td>7</td><td>11</td><td>5</td><td>2</td></tr><tr><td>D9</td><td>15</td><td>2</td><td>4</td><td>5</td><td>2</td></tr><tr><td>D10</td><td>30*</td><td>9</td><td>11</td><td>6</td><td>3*</td></tr><tr><td>D11</td><td>30</td><td>9</td><td>12</td><td>9</td><td>5</td></tr><tr><td>D12</td><td>2*</td><td>2</td><td>0</td><td>3</td><td>2</td></tr><tr><td>D13</td><td>30</td><td>9</td><td>11</td><td>6</td><td>2</td></tr><tr><td>D14</td><td>18*</td><td>0</td><td>6</td><td>4</td><td>2</td></tr><tr><td>D15</td><td>-</td><td>5</td><td>6</td><td>5</td><td>2</td></tr><tr><td>D16</td><td>30*</td><td>2</td><td>8</td><td>5</td><td>2</td></tr></tbody></table><p class="note">*추가 지침은 DRV '봇 규칙을 참조하세요.</p>`,
        "🅟 SAM & AAA 지도 상 마커 범례": `<div style="display: flex; flex-wrap: wrap; gap: 10px;"><div class="highlight" style="flex: 1; min-width: 250px;"><p><strong>SAM 상태:</strong></p><ul style="list-style: none; padding: 0;"><li style="display: flex; align-items: center; margin: 4px 0;"><img src="1.png" alt="marker" style="width:40px;height:40px;margin-right: 8px;"> 비활성 SAM (시나리오 시작 시 SAM 준비)</li><li style="display: flex; align-items: center; margin: 4px 0;"><img src="2.png" alt="marker" style="width:40px;height:40px;margin-right: 8px;"> 활성 SAM - 위치 불명 (3발 남음)</li><li style="display: flex; align-items: center; margin: 4px 0;"><img src="3.png" alt="marker" style="width:40px;height:40px;margin-right: 8px;"> 활성 SAM - 위치 불명 (레이더 종료, 탄약 고갈)</li><li style="display: flex; align-items: center; margin: 4px 0;"><img src="4.png" alt="marker" style="width:40px;height:40px;margin-right: 8px;"> 활성 SAM - 위치 확인 (3발 남음)</li><li style="display: flex; align-items: center; margin: 4px 0;"><img src="5.png" alt="marker" style="width:40px;height:40px;margin-right: 8px;"> 활성 SAM - 위치 확인 (레이더 종료, 탄약 고갈)</li><li style="display: flex; align-items: center; margin: 4px 0;"><img src="6.png" alt="marker" style="width:40px;height:40px;margin-right: 8px;"> 비활성 AAA (시나리오 시작 시 AAA 준비)</li></ul></div><div class="highlight" style="flex: 1; min-width: 250px;"><p><strong>카운터 방향으로 잔탄 표시</strong></p><ul style="list-style: none; padding: 0;"><li style="display: flex; align-items: center; margin: 4px 0;"><img src="11.png" alt="marker" style="width:40px;height:40px;margin-right: 8px;"> 2발 남음</li><li style="display: flex; align-items: center; margin: 4px 0;"><img src="22.png" alt="marker" style="width:40px;height:40px;margin-right: 8px;"> 1발 남음</li><li style="display: flex; align-items: center; margin: 4px 0;"><img src="33.png" alt="marker" style="width:40px;height:40px;margin-right: 8px;"> 탄약 고갈</li></ul></div></div><div class="note">[선택사항] — SAM 탄약을 추적하는 대신, 공대공 무기와 같이 {3}을 사용하여 탄약 고갈을 굴립니다. 일제 사격을 하는 경우 굴림에 -3을 보정합니다.</div>`,
        "🅠 종료 시 MAP": `<p>시나리오 종료 시, 모든 실제 DRV 비행대의 총 MAP를 합산하고 시나리오 설정 지침과 비교합니다. 적절히 US VP를 부여합니다.</p><table class="table"><tbody><tr><th>항공기</th><th>MiG-17F</th><th>MiG-19S</th><th>MiG-21 F-13/PF/PFM</th><th>MiG-21MF</th></tr><tr><td>1x</td><td>—</td><td>—</td><td>—</td><td>9</td></tr><tr><td>2x</td><td>8</td><td>9</td><td>13</td><td>14</td></tr><tr><td>3x</td><td>10</td><td>12</td><td>18</td><td>19</td></tr><tr><td>4x</td><td>12</td><td>15</td><td>23</td><td>24</td></tr></tbody></table>`,
        "🅡 준비 단계": `<ol><li>SAM 준비(setup) 마커를 배치합니다.</li><li>비활성 AAA 마커를 배치합니다.</li><li>파이어 캔 마커를 수집합니다.</li><li>US 비행대와 경로를 설정합니다.</li><li>SAM 경고 마커를 배치합니다.</li><li>조기 경보를 굴리고 일반 MiG를 배치합니다(있는 경우).</li></ol>`,
        "🅩 발사 후 락온 표": `<p>[선택사항] 1967년 8월 이후인 경우, 탐지된 US 비행대가 비활성 SAM의 5헥스 이내로 이동할 때마다 LOAL 확인을 합니다.</p><div class="highlight"><strong>LOAL</strong> <span class="dice-formula">(1d10)</span>: ≤ 3 <span class="result">사격</span>; ≥ 4 <span class="result">사격 안 함</span></div><table class="table"><tbody><tr><th>결과</th><th></th></tr><tr><td><strong>사격 발생 O</strong></td><td>SAM을 활성화하고 사격을 유발한 US 비행대에 일제 사격을 시도합니다</td></tr><tr><td><strong>사격 발생 X</strong></td><td>SAM은 활성화되지 않습니다</td></tr></tbody></table>`
    };

    document.addEventListener('DOMContentLoaded', () => {
        // FAB and SOP Modal Logic
        const fab = document.getElementById('fab');
        const sopModal = document.getElementById('sopModal');
        const closeSopModal = document.getElementById('closeModal');

        fab.addEventListener('click', () => sopModal.classList.add('show'));
        closeSopModal.addEventListener('click', () => sopModal.classList.remove('show'));

        // Table Reference Modal Logic
        const refModal = document.getElementById('refModal');
        const refModalTitle = document.getElementById('refModalTitle');
        const refModalContent = document.getElementById('refModalContent');
        const closeRefModal = refModal.querySelector('.close-button');

        function showRefModal(title) {
            // 다른 모달에 적용되었을 수 있는 크기 조정 클래스를 먼저 제거합니다.
            refModal.classList.remove('modal-large');

            refModalTitle.textContent = title;
            
            const content = refContentData[title.trim()];

            if (content) {
                refModalContent.innerHTML = content;
                // "무작위 이벤트" 모달인 경우에만 크기 조정 클래스를 추가합니다.
                if (title.trim() === "무작위 이벤트") {
                    refModal.classList.add('modal-large');
                }
            } else {
                refModalContent.innerHTML = '해당 내용을 찾을 수 없습니다.';
            }
            refModal.classList.add('show');
        }

        document.querySelectorAll('.table-ref').forEach(el => {
            el.addEventListener('click', (e) => {
                const title = e.target.textContent;
                showRefModal(title);
            });
        });

        closeRefModal.addEventListener('click', () => refModal.classList.remove('show'));

        // 모달 바깥 영역 클릭 시 닫기
        window.addEventListener('click', (event) => {
            // sopModal이 열려있고, 클릭된 곳이 모달 내부가 아닐 때
            if (sopModal.classList.contains('show') && !event.target.closest('#sopModal .modal-dialog') && !event.target.closest('#sopModal .modal-content') && event.target !== fab) {
                sopModal.classList.remove('show');
            }

            // refModal이 열려있고, 클릭된 곳이 모달 내부나 참조 링크가 아닐 때
            if (refModal.classList.contains('show') && !event.target.closest('#refModal .modal-dialog') && !event.target.closest('#refModal .modal-content') && !event.target.closest('.table-ref')) {
                refModal.classList.remove('show');
            }
        });
    });
</script>
</body>
</html>